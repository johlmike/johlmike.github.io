<!doctype html>
<html lang="en">

<head>
  <title>萌兔窩 - 管理後台</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link href="https://unpkg.com/vuesax@4.0.1-alpha.16/dist/vuesax.min.css" rel="stylesheet">
  <link rel="stylesheet" href="./css/all.css">
  <link rel="stylesheet" href="./css/products.css">
</head>

<body style="font-family:'微軟正黑體', Arial, Helvetica, sans-serif">
  <div id="app">
    <loading-page :loading="isLoading"></loading-page>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="#">萌兔窩 - 管理後台</a>
    </nav>
    <div class="container">
      <br>
      <div class="row flex-row-reverse">
        <button type="button" class="btn btn-primary" @click="toggleModal('new')">新增商品</button>
      </div>
      <table-list :products="products" :page="page" @update-product="updateProduct" @toggle-hot="toggleHot"
        @toggle-modal="toggleModal" @delete-product="deleteProduct">
      </table-list>
    </div>
    <!-- Modal -->
    <div class="modal fade bd-example-modal-xl" tabindex="-1" role="dialog" aria-labelledby="productModal"
      aria-hidden="true" id="productModal">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-body">
            <div class="container-fluid">
              <div class="row">
                <div class="col-sm-4">
                  <!-- 一次最多上傳五張圖片 -->
                  <template v-for="index in 5">
                    <div class="form-group" :key="editingProduct.id + '_' + index">
                      <label :for="'imageUrl' + '_' + index">圖片網址</label>
                      <input type="text" :id="'imageUrl' + '_' + index" class="form-control"
                        v-model.lazy="editingProduct.imageUrl[index-1]"
                        @change.lazy="editingProduct.imageUrl = filterImageUrl">
                    </div>
                    <img v-show="editingProduct.imageUrl[index-1]" :src="editingProduct.imageUrl[index-1]"
                      :alt="editingProduct.title + '_' +  index" class="img-fluid mb-2">
                  </template>
                </div>
                <div class="col-sm-8">
                  <div class="form-group">
                    <label for="title">商品名稱</label>
                    <input type="text" name="title" id="title" class="form-control" v-model="editingProduct.title">
                  </div>
                  <div class="form-row">
                    <div class="col">
                      <div class="form-group">
                        <label for="category">商品分類</label>
                        <input type="text" name="category" id="category" class="form-control"
                          v-model="editingProduct.category">
                      </div>
                    </div>
                    <div class="col">
                      <div class="form-group">
                        <label for="stock">庫存</label>
                        <input type="number" name="stock" id="stock" class="form-control"
                          v-model="editingProduct.options.stock" min="0">
                      </div>
                    </div>
                    <div class="col">
                      <div class="form-group">
                        <label for="unit">單位</label>
                        <input type="text" name="unit" id="unit" class="form-control" v-model="editingProduct.unit">
                      </div>
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="col">
                      <div class="form-group">
                        <label for="origin_price">原價</label>
                        <input type="number" name="origin_price" id="origin_price" class="form-control"
                          v-model="editingProduct.origin_price">
                      </div>
                    </div>
                    <div class="col">
                      <div class="form-group">
                        <label for="price">售價</label>
                        <input type="number" name="price" id="price" class="form-control" v-model="editingProduct.price"
                          min="0">
                      </div>
                    </div>
                    <div class="col">
                    </div>
                  </div>
                  <div class="form-row">
                    <div class="col">
                      <label for="content">商品敘述</label>
                      <textarea class="form-control" id="content" rows="3" v-model="editingProduct.content"></textarea>
                    </div>
                    <div class="col">
                      <label for="description">商品說明</label>
                      <textarea class="form-control" id="description" rows="3"
                        v-model="editingProduct.description"></textarea>
                    </div>
                  </div>
                  <div class="form-row mt-3">
                    <div class="col">
                      <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="enabled"
                          v-model="editingProduct.enabled">
                        <label class="custom-control-label" for="enabled">是否上架？</label>
                      </div>
                    </div>
                    <div class="col">
                      <div class="custom-control custom-switch">
                        <input type="checkbox" class="custom-control-input" id="hot"
                          v-model="editingProduct.options.hot">
                        <label class="custom-control-label" for="hot">是否為熱門商品？</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">取消</button>
            <button type="button" class="btn btn-primary" @click="updateProduct" v-show="!isCreating">儲存修改</button>
            <button type="button" class="btn btn-primary" @click="createProduct" v-show="isCreating">新增商品</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Optionsal JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://unpkg.com/vuesax@4.0.1-alpha.16/dist/vuesax.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.15/lodash.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="./js/products.js" type="module"></script>
</body>

</html>